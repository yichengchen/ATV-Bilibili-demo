#!/bin/bash

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# BilibiliLive TestFlight éƒ¨ç½²è„šæœ¬
#
# ç”¨é€”ï¼šå¸®åŠ©å¼€å‘è€…å°† tvOS åº”ç”¨æ‰“åŒ…å¹¶ä¸Šä¼ åˆ° TestFlight
# ä½¿ç”¨ï¼š./scripts/testflight_deploy.sh
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -e

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# é¡¹ç›®é…ç½®
PROJECT_NAME="BilibiliLive"
SCHEME="BilibiliLive"
PROJECT_FILE="BilibiliLive.xcodeproj"
BUILD_DIR="./build"
ARCHIVE_PATH="${BUILD_DIR}/${PROJECT_NAME}.xcarchive"
EXPORT_PATH="${BUILD_DIR}/export"

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# è¾…åŠ©å‡½æ•°
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

print_header() {
    echo -e "\n${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${CYAN}â•‘     BilibiliLive TestFlight éƒ¨ç½²å·¥å…·                   â•‘${NC}"
    echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\n"
}

print_step() {
    echo -e "\n${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${YELLOW}ğŸ“Œ $1${NC}"
    echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}\n"
}

print_success() {
    echo -e "${GREEN}âœ… $1${NC}"
}

print_error() {
    echo -e "${RED}âŒ $1${NC}"
}

print_info() {
    echo -e "${BLUE}â„¹ï¸  $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}âš ï¸  $1${NC}"
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ£€æŸ¥ç¯å¢ƒ
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

check_environment() {
    print_step "æ£€æŸ¥ç¯å¢ƒ"

    # æ£€æŸ¥ Xcode
    if ! command -v xcodebuild &> /dev/null; then
        print_error "æœªæ‰¾åˆ° Xcodeï¼Œè¯·å…ˆå®‰è£… Xcode"
        exit 1
    fi

    XCODE_VERSION=$(xcodebuild -version | head -n1)
    print_success "Xcode: $XCODE_VERSION"

    # æ£€æŸ¥é¡¹ç›®æ–‡ä»¶
    if [ ! -f "$PROJECT_FILE" ]; then
        print_error "æœªæ‰¾åˆ°é¡¹ç›®æ–‡ä»¶: $PROJECT_FILE"
        print_info "è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæ­¤è„šæœ¬"
        exit 1
    fi
    print_success "é¡¹ç›®æ–‡ä»¶: $PROJECT_FILE"

    # æ£€æŸ¥ç­¾åé…ç½®
    print_info "æ£€æŸ¥ç­¾åé…ç½®..."

    # åˆ›å»ºæ„å»ºç›®å½•
    mkdir -p "$BUILD_DIR"
    print_success "æ„å»ºç›®å½•: $BUILD_DIR"
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ˜¾ç¤ºé…ç½®æŒ‡å—
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

show_setup_guide() {
    print_step "é¦–æ¬¡é…ç½®æŒ‡å—"

    echo -e "${CYAN}åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®Œæˆä»¥ä¸‹é…ç½®ï¼š${NC}\n"

    echo "1ï¸âƒ£  App Store Connect é…ç½®"
    echo "   â€¢ ç™»å½• https://appstoreconnect.apple.com"
    echo "   â€¢ åˆ›å»ºæ–° Appï¼ˆå¹³å°é€‰æ‹© tvOSï¼‰"
    echo "   â€¢ è®°ä¸‹ Bundle ID"
    echo ""

    echo "2ï¸âƒ£  Xcode ç­¾åé…ç½®"
    echo "   â€¢ æ‰“å¼€ $PROJECT_FILE"
    echo "   â€¢ é€‰æ‹© $PROJECT_NAME Target â†’ Signing & Capabilities"
    echo "   â€¢ Team: é€‰æ‹©ä½ çš„å¼€å‘è€…è´¦å·"
    echo "   â€¢ Bundle Identifier: æ”¹ä¸ºä½ çš„ Bundle ID"
    echo "   â€¢ å‹¾é€‰ Automatically manage signing"
    echo ""

    echo "3ï¸âƒ£  ç‰ˆæœ¬å·é…ç½®"
    echo "   â€¢ General â†’ Version: è®¾ç½®ç‰ˆæœ¬å·ï¼ˆå¦‚ 1.0.0ï¼‰"
    echo "   â€¢ General â†’ Build: è®¾ç½®æ„å»ºå·ï¼ˆå¦‚ 1ï¼‰"
    echo ""

    read -p "æ˜¯å¦å·²å®Œæˆä»¥ä¸Šé…ç½®ï¼Ÿ(y/n): " configured
    if [[ "$configured" != "y" && "$configured" != "Y" ]]; then
        print_info "è¯·å…ˆå®Œæˆé…ç½®ï¼Œç„¶åé‡æ–°è¿è¡Œè„šæœ¬"
        echo ""
        echo "å¿«é€Ÿæ‰“å¼€é¡¹ç›®ï¼š"
        echo "  open $PROJECT_FILE"
        echo ""
        exit 0
    fi
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ¸…ç†æ—§æ„å»º
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

clean_build() {
    print_step "æ¸…ç†æ—§æ„å»º"

    if [ -d "$BUILD_DIR" ]; then
        rm -rf "$BUILD_DIR"
        print_success "å·²æ¸…ç†: $BUILD_DIR"
    fi

    mkdir -p "$BUILD_DIR"
    mkdir -p "$EXPORT_PATH"

    print_info "æ¸…ç† Xcode æ„å»ºç¼“å­˜..."
    xcodebuild clean -project "$PROJECT_FILE" -scheme "$SCHEME" -quiet 2>/dev/null || true
    print_success "æ¸…ç†å®Œæˆ"
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ„å»º Archive
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

build_archive() {
    print_step "æ„å»º Archive"

    print_info "ç›®æ ‡å¹³å°: tvOS (arm64)"
    print_info "é…ç½®: Release"
    print_info "è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ..."
    echo ""

    # æ„å»º Archive
    xcodebuild -project "$PROJECT_FILE" \
               -scheme "$SCHEME" \
               -destination "generic/platform=tvOS" \
               -configuration Release \
               -archivePath "$ARCHIVE_PATH" \
               archive \
               | grep -E "^(Compiling|Linking|Archive|error:|warning:|\*\*)" || true

    # æ£€æŸ¥æ˜¯å¦æˆåŠŸ
    if [ -d "$ARCHIVE_PATH" ]; then
        print_success "Archive æ„å»ºæˆåŠŸ!"
        print_info "è·¯å¾„: $ARCHIVE_PATH"
    else
        print_error "Archive æ„å»ºå¤±è´¥"
        print_info "è¯·æ£€æŸ¥ Xcode ç­¾åé…ç½®æ˜¯å¦æ­£ç¡®"
        exit 1
    fi
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# åˆ›å»ºå¯¼å‡ºé…ç½®
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

create_export_options() {
    print_step "åˆ›å»ºå¯¼å‡ºé…ç½®"

    EXPORT_OPTIONS_PATH="${BUILD_DIR}/ExportOptions.plist"

    cat > "$EXPORT_OPTIONS_PATH" << 'EOF'
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>method</key>
    <string>app-store-connect</string>
    <key>destination</key>
    <string>upload</string>
    <key>signingStyle</key>
    <string>automatic</string>
    <key>uploadSymbols</key>
    <true/>
    <key>testFlightInternalTestingOnly</key>
    <false/>
</dict>
</plist>
EOF

    print_success "å¯¼å‡ºé…ç½®å·²åˆ›å»º: $EXPORT_OPTIONS_PATH"
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ä¸Šä¼ åˆ° App Store Connect
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

upload_to_appstore() {
    print_step "ä¸Šä¼ åˆ° App Store Connect"

    echo -e "${CYAN}è¯·é€‰æ‹©ä¸Šä¼ æ–¹å¼ï¼š${NC}"
    echo "1) ä½¿ç”¨ Xcode Organizer (æ¨èæ–°æ‰‹)"
    echo "2) ä½¿ç”¨å‘½ä»¤è¡Œä¸Šä¼ "
    echo ""
    read -p "è¯·é€‰æ‹© (1/2): " upload_method

    case $upload_method in
        1)
            upload_via_organizer
            ;;
        2)
            upload_via_cli
            ;;
        *)
            print_warning "æ— æ•ˆé€‰æ‹©ï¼Œé»˜è®¤ä½¿ç”¨ Xcode Organizer"
            upload_via_organizer
            ;;
    esac
}

upload_via_organizer() {
    print_info "æ­£åœ¨æ‰“å¼€ Xcode Organizer..."
    echo ""
    echo -e "${CYAN}è¯·åœ¨ Organizer ä¸­å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š${NC}"
    echo "1. é€‰æ‹©åˆšæ‰çš„ Archive"
    echo "2. ç‚¹å‡» 'Distribute App'"
    echo "3. é€‰æ‹© 'TestFlight & App Store Connect'"
    echo "4. é€‰æ‹© 'Upload'"
    echo "5. æŒ‰æç¤ºå®Œæˆä¸Šä¼ "
    echo ""

    # æ‰“å¼€ Organizer
    open "$ARCHIVE_PATH"

    print_info "Organizer å·²æ‰“å¼€ï¼Œè¯·æŒ‰ä¸Šè¿°æ­¥éª¤æ“ä½œ"
}

upload_via_cli() {
    print_info "ä½¿ç”¨å‘½ä»¤è¡Œä¸Šä¼ "

    # å¯¼å‡º IPA
    print_info "æ­£åœ¨å¯¼å‡º IPA..."

    EXPORT_OPTIONS_PATH="${BUILD_DIR}/ExportOptions.plist"

    xcodebuild -exportArchive \
               -archivePath "$ARCHIVE_PATH" \
               -exportPath "$EXPORT_PATH" \
               -exportOptionsPlist "$EXPORT_OPTIONS_PATH" \
               | grep -E "^(Export|error:|warning:|\*\*)" || true

    IPA_PATH="${EXPORT_PATH}/${PROJECT_NAME}.ipa"

    if [ -f "$IPA_PATH" ]; then
        print_success "IPA å¯¼å‡ºæˆåŠŸ: $IPA_PATH"
    else
        print_error "IPA å¯¼å‡ºå¤±è´¥"
        print_info "å»ºè®®ä½¿ç”¨ Xcode Organizer æ–¹å¼ä¸Šä¼ "
        exit 1
    fi

    # ä¸Šä¼ 
    echo ""
    read -p "è¯·è¾“å…¥ Apple ID: " apple_id
    echo ""
    print_info "è¯·è¾“å…¥ App ä¸“ç”¨å¯†ç ï¼ˆåœ¨ appleid.apple.com ç”Ÿæˆï¼‰"
    read -s -p "App ä¸“ç”¨å¯†ç : " app_password
    echo ""

    print_info "æ­£åœ¨ä¸Šä¼ åˆ° App Store Connect..."

    xcrun altool --upload-app \
                 -f "$IPA_PATH" \
                 -t appletvos \
                 -u "$apple_id" \
                 -p "$app_password"

    if [ $? -eq 0 ]; then
        print_success "ä¸Šä¼ æˆåŠŸ!"
    else
        print_error "ä¸Šä¼ å¤±è´¥"
        print_info "è¯·æ£€æŸ¥ Apple ID å’Œ App ä¸“ç”¨å¯†ç æ˜¯å¦æ­£ç¡®"
        exit 1
    fi
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ˜¾ç¤ºåç»­æ­¥éª¤
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

show_next_steps() {
    print_step "åç»­æ­¥éª¤"

    echo -e "${CYAN}ä¸Šä¼ å®Œæˆåï¼Œè¯·åœ¨ App Store Connect ä¸­ï¼š${NC}"
    echo ""
    echo "1. ç­‰å¾…å¤„ç†ï¼ˆçº¦ 10-30 åˆ†é’Ÿï¼‰"
    echo "   â€¢ ç™»å½• https://appstoreconnect.apple.com"
    echo "   â€¢ è¿›å…¥ä½ çš„ App â†’ TestFlight"
    echo "   â€¢ ç­‰å¾…æ„å»ºç‰ˆæœ¬çŠ¶æ€å˜ä¸ºã€Œå¯ç”¨ã€"
    echo ""
    echo "2. é…ç½®æµ‹è¯•ä¿¡æ¯"
    echo "   â€¢ ç‚¹å‡»æ„å»ºç‰ˆæœ¬ â†’ å¡«å†™ã€Œæµ‹è¯•é¡»çŸ¥ã€"
    echo ""
    echo "3. é‚€è¯·æµ‹è¯•è€…"
    echo "   â€¢ å†…éƒ¨æµ‹è¯•ï¼šæ·»åŠ  App Store Connect ç”¨æˆ·"
    echo "   â€¢ å¤–éƒ¨æµ‹è¯•ï¼šæ·»åŠ é‚®ç®±ï¼ˆé¦–æ¬¡éœ€å®¡æ ¸ï¼‰"
    echo ""
    echo "4. æµ‹è¯•è€…å®‰è£…"
    echo "   â€¢ Apple TV ä¸Šä¸‹è½½ TestFlight App"
    echo "   â€¢ ç™»å½•å¹¶æ¥å—é‚€è¯·"
    echo ""

    print_success "éƒ¨ç½²æµç¨‹å®Œæˆï¼"
}

#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ä¸»æµç¨‹
#â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

main() {
    print_header

    check_environment
    show_setup_guide
    clean_build
    build_archive
    create_export_options
    upload_to_appstore
    show_next_steps
}

# è¿è¡Œä¸»æµç¨‹
main "$@"
